import{m as o}from"./module.esm.860ebcbd.js";import{s as r}from"./forms.8e7f478f.js";import{C as l,i as a}from"./base.29aca91b.js";import{c as d}from"./clipboard.ea7c673c.js";import"./duration.21bcce5f.js";import"./echarts.4cc66d9c.js";import"./notificationCounter.4f4e1e9f.js";import"./tippy.esm.67f4ecc9.js";window.Alpine=o;o.data("SettingsForm",()=>({success:null,error:null,initial:null,errors:[],init(){this.initial=r(this.$el)},async updateProfile(){this.success=null,this.error=null,this.errors=[];let e=r(this.$el,this.initial,!0);e.fields=[];for(const s in e)if(s.match(/fields\[\d+\]/)){let i={},n=parseInt(s.slice(7,-1));i.field_id=n,i.value=e[s],e.fields.push(i),delete e[s]}const t=await l.pages.settings.updateSettings(e);t.success?(this.success=!0,this.error=!1,setTimeout(()=>{this.success=null,this.error=null},3e3)):(this.success=!1,this.error=!0,Object.keys(t.errors).map(s=>{const i=t.errors[s];this.errors.push(i)}))}}));o.data("TokensForm",()=>({token:null,init(){a(this.$refs.tokenModal,[],[this.$refs.tokenModalClose])},async generateToken(){const e=r(this.$el);e.expiration||delete e.expiration;const t=await l.pages.settings.generateToken(e);this.token=t.data.value,this.$refs.tokenModal.showModal()},copyToken(){d(this.$refs.token)}}));o.data("Tokens",()=>({selectedTokenId:null,hideModal:()=>{},init(){this.hideModal=a(this.$refs.deleteModal,[],[this.$refs.deleteModalClose])},async deleteTokenModal(e){this.selectedTokenId=e,this.$refs.deleteModal.showModal()},async deleteSelectedToken(){await l.pages.settings.deleteToken(this.selectedTokenId);const e=this.$refs[`token-${this.selectedTokenId}`];e&&e.remove(),this.hideModal()}}));o.start();
