import{m as i}from"./module.esm.860ebcbd.js";import{C as o,i as l,g as r}from"./base.29aca91b.js";import{s as n}from"./forms.8e7f478f.js";import{c as m}from"./clipboard.ea7c673c.js";import{_ as c}from"./duration.21bcce5f.js";import"./echarts.4cc66d9c.js";import"./notificationCounter.4f4e1e9f.js";import"./tippy.esm.67f4ecc9.js";i.data("TeamEditModal",()=>({success:null,error:null,initial:null,submitting:!1,errors:[],init(){this.initial=n(this.$el.querySelector("form"))},async updateProfile(){let e=n(this.$el,this.initial,!0);e.fields=[];for(const t in e)if(t.match(/fields\[\d+\]/)){let s={},d=parseInt(t.slice(7,-1));s.field_id=d,s.value=e[t],e.fields.push(s),delete e[t]}this.errors=[],this.submitting=!0;let a=await o.pages.teams.updateTeamSettings(e);this.submitting=!1,a.success?(this.success=!0,this.error=!1,setTimeout(()=>{this.success=null,this.error=null},3e3)):(this.success=!1,this.error=!0,Object.keys(a.errors).map(t=>{const s=a.errors[t];this.errors.push(s)}))}}));i.data("TeamCaptainModal",()=>({success:null,error:null,errors:[],async updateCaptain(){let e=n(this.$el,null,!0),a=await o.pages.teams.updateTeamSettings(e);a.success?window.location.reload():(this.success=!1,this.error=!0,Object.keys(a.errors).map(t=>{const s=a.errors[t];this.errors.push(s)}))}}));i.data("TeamInviteModal",()=>({copy(){m(this.$refs.link)}}));i.data("TeamDisbandModal",()=>({errors:[],async disbandTeam(){let e=await o.pages.teams.disbandTeam();e.success?window.location.reload():this.errors=e.errors[""]}}));i.data("CaptainMenu",()=>({captain:!1,teamEditModal:null,teamCaptainModal:null,teamInviteModal:null,teamDisbandModal:null,init(){this.teamEditModal=document.getElementById("teamEditModal");const e=document.getElementById("teamEditModalClose");l(teamEditModal,[],[e]),this.teamCaptainModal=document.getElementById("teamCaptainModal");const a=document.getElementById("teamCaptainModalClose");l(teamCaptainModal,[],[a]),this.teamInviteModal=document.getElementById("teamInviteModal");const t=document.getElementById("teamInviteModalClose");l(teamInviteModal,[],[t]),this.teamDisbandModal=document.getElementById("teamDisbandModal");const s=document.getElementById("teamDisbandModalClose");l(teamDisbandModal,[],[s])},editTeam(){this.teamEditModal.showModal()},chooseCaptain(){this.teamCaptainModal.showModal()},async inviteMembers(){const e=await o.pages.teams.getInviteToken();if(e.success){const a=e.data.code,t=`${window.location.origin}${o.config.urlRoot}/teams/invite?code=${a}`;document.querySelector("#teamInviteModal input[name=link]").value=t,this.$store.inviteToken=t,this.teamInviteModal.showModal()}else console.log(e),r(c("Invite users"),e.errors[""].join("<br>"))},disbandTeam(){this.teamDisbandModal.showModal()}}));
