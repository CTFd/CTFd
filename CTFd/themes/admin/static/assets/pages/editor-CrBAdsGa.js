import{$ as t,P as p,A as s,B as l,C as n,E as m,D as u}from"./main-DvY3K8eO.js";import{C as f}from"../htmlmixed-SxqHQm5p.js";import{C as g}from"../CommentBox-DAFh8Ri2.js";function w(){window.editor.save();var e=t("#page-edit").serializeJSON(),r="/api/v1/pages",o="POST";let d=window.location.pathname.split("/").pop();d!=="new"&&(r+="/"+d,o="PATCH"),e.link_target===""&&(e.link_target=null),n.fetch(r,{method:o,credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(i){return i.json()}).then(function(i){if(i.success===!1){let a="";for(const c in i.errors)a+=i.errors[c].join(`
`),a+=`
`;m({title:"Error",body:a,button:"OK"});return}o==="PATCH"&&i.success?u({title:"Saved",body:"Your changes have been saved"}):window.location=n.config.urlRoot+"/admin/pages/"+i.data.id})}function v(){window.editor.save(),t("#page-edit").attr("action",n.config.urlRoot+"/admin/pages/preview"),t("#page-edit").attr("target","_blank"),t("#page-edit").submit()}t(()=>{if(window.editor=f.fromTextArea(document.getElementById("admin-pages-editor"),{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",htmlMode:!0}),t("#media-button").click(function(e){p(window.editor)}),t("#save-page").click(function(e){e.preventDefault(),w()}),t(".preview-page").click(function(){v()}),window.PAGE_ID){let e=document.createElement("div");document.querySelector("#comment-box").appendChild(e),s({render:()=>l(g,{type:"page",id:window.PAGE_ID})}).mount(e)}});
