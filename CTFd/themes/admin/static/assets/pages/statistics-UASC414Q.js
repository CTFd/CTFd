import{$ as c,N as v,C as y}from"./main-sbGV3kXM.js";import{e as u}from"../echarts.common-BkpF2UHI.js";import{l as b}from"../index-TjCxX7sJ.js";const l=b("http://127.0.0.1:4000");l.on("connect",function(){console.log("Conectado al servidor")});function i(e,s){const o=document.getElementById(e);o&&(o.textContent=s)}let d=null,p=null,m=null,h=null,g=null,f=null;function x(e){const s=document.querySelector("#solves-graph");if(!s)return;if(!p){p=u.init(s);const n={title:{left:"center",text:"Solve Counts"},tooltip:{trigger:"item"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:{name:"Solve Count",nameLocation:"middle",type:"value"},yAxis:{name:"Challenge Name",nameLocation:"middle",nameGap:60,type:"category",axisLabel:{interval:0,rotate:0},data:[]},series:[{label:{show:!0},data:[],type:"bar",itemStyle:{color:"#1f76b4"}}]};p.setOption(n),c(window).on("resize",()=>p.resize())}if(!Array.isArray(e.data))return;const o=[],r=[],a={};e.data.forEach(n=>{a[n.id]={name:n.name,solves:n.solves}}),Object.keys(a).sort((n,w)=>a[w].solves-a[n].solves).forEach(n=>{o.push(a[n].name),r.push(a[n].solves)}),p.setOption({yAxis:{data:o},series:[{data:r}]})}function S(e){const s=document.querySelector("#score-distribution-graph");if(!s)return;if(!m){m=u.init(s);const a={title:{left:"center",text:"Score Distribution"},tooltip:{trigger:"item"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:{name:"Score Bracket",nameGap:40,nameLocation:"middle",type:"category",data:[]},yAxis:{name:"Number of Teams/Users",nameGap:50,nameLocation:"middle",type:"value"},dataZoom:[{show:!1,start:0,end:100},{type:"inside",show:!0,start:0,end:100},{fillerColor:"rgba(233, 236, 241, 0.4)",show:!0,right:60,yAxisIndex:0,width:20},{type:"slider",fillerColor:"rgba(233, 236, 241, 0.4)",top:35,height:20,show:!0,start:0,end:100}],series:[{label:{show:!0},data:[],type:"bar",itemStyle:{color:"#1f76b4"}}]};m.setOption(a),c(window).on("resize",()=>m.resize())}if(!e.data||!e.data.brackets)return;const o=Object.keys(e.data.brackets).sort((a,t)=>a-t),r=o.map(a=>e.data.brackets[a]);m.setOption({xAxis:{data:o},series:[{data:r}]})}function C(e){const s=document.querySelector("#keys-pie-graph");if(!s)return;if(!h){h=u.init(s);const a={title:{left:"center",text:"Submission Percentages"},tooltip:{trigger:"item"},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{}}},legend:{orient:"vertical",top:"middle",right:0,data:["Fails","Solves"]},series:[{name:"Submission Percentages",type:"pie",radius:["30%","50%"],data:[]}]};h.setOption(a),c(window).on("resize",()=>h.resize())}const o=e.data.correct||0,r=e.data.incorrect||0;h.setOption({series:[{data:[{value:r,name:"Fails",itemStyle:{color:"rgb(207, 38, 0)"}},{value:o,name:"Solves",itemStyle:{color:"rgb(0, 209, 64)"}}]}]})}function O(e){const s=document.querySelector("#categories-pie-graph");if(!s)return;if(!g){g=u.init(s);const t={title:{left:"center",text:"Categories Distribution"},tooltip:{trigger:"item"},legend:{orient:"vertical",top:"middle",right:0,data:[]},series:[{name:"Categories",type:"pie",radius:["30%","50%"],data:[]}]};g.setOption(t),c(window).on("resize",()=>g.resize())}const o={};e.data.forEach(t=>{t.category&&(o[t.category]=(o[t.category]||0)+1)});const r=Object.keys(o),a=r.map(t=>o[t]);g.setOption({leyend:{data:r},series:[{data:r.map((t,n)=>({value:a[n],name:t,itemStyle:{color:v(t)}}))}]})}function A(e){const s=document.querySelector("#points-pie-graph");if(!s)return;if(!f){f=u.init(s);const t={title:{left:"center",text:"Points Distribution"},tooltip:{trigger:"item"},legend:{orient:"vertical",top:"middle",right:0,data:[]},series:[{name:"Points",type:"pie",radius:["30%","50%"],data:[]}]};f.setOption(t),c(window).on("resize",()=>f.resize())}const o={};e.data.forEach(t=>{const n=t.points||t.value;o[n]=(o[n]||0)+1});const r=Object.keys(o),a=r.map(t=>o[t]);f.setOption({legend:{data:r.map(t=>`Points: ${t}`)},series:[{data:r.map((t,n)=>({value:a[n],name:`Points: ${t}`,itemStyle:{color:v(`Points: ${t}`)}}))}]})}function k(e){const s=document.querySelector("#solve-percentages-graph");if(!s)return;if(!d){d=u.init(s);const t={title:{left:"center",text:"Solve Percentages per Challenge"},tooltip:{trigger:"item",formatter:function(n){return`${n.name} - ${(Math.round(n.value*10)/10).toFixed(1)}%`}},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:{name:"Challenge Name",nameGap:40,nameLocation:"middle",type:"category",data:[],axisLabel:{interval:0,rotate:50}},yAxis:{name:`Percentage of ${y.config.userMode.charAt(0).toUpperCase()+y.config.userMode.slice(1)} (%)`,nameGap:50,nameLocation:"middle",type:"value",min:0,max:100},dataZoom:[{show:!1,start:0,end:100},{type:"inside",show:!0,start:0,end:100},{fillerColor:"rgba(233, 236, 241, 0.4)",show:!0,right:60,yAxisIndex:0,width:20},{type:"slider",fillerColor:"rgba(233, 236, 241, 0.4)",top:35,height:20,show:!0,start:0,end:100}],series:[{name:"Solved %",type:"bar",itemStyle:{color:"#1f76b4"},data:[]}]};d.setOption(t),c(window).on("resize",()=>d.resize())}if(!e.data||!e.data.challenges)return;const o=e.data.challenges,r=o.map(t=>t.name),a=o.map(t=>t.solve_percentage);d.setOption({xAxis:{data:r},series:[{data:a}]})}l.on("challenge_stats",function(e){x(e),O(e),A(e);const s=e.data||[];if(s.length>0){let o=s[0],r=s[0];for(const a of s)a.solves>o.solves&&(o=a),a.solves<r.solves&&(r=a);i("challenge-count",s.length),i("most-solved",o.name),i("most-solved-count",o.solves),i("least-solved",r.name),i("least-solved-count",r.solves)}});l.on("scores_distribution",S);l.on("submissions_stats",C);l.on("users_stats",function(e){i("user-count",e.data.registered)});l.on("teams_stats",function(e){i("team-count",e.data.registered)});l.on("solve_percentages_stats",function(e){k(e),i("solve-count",e.data.solved),i("wrong-count",e.data.unsolved)});c(document).ready(function(){l.emit("request_initial_data")});
